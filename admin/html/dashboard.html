<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard â€“ Skiloora</title>
  <link rel="stylesheet" href="../css/admin.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="../js/nav.js"></script>
</head>
<body class="admin-app">
  <div class="overlay" id="menuOverlay" aria-hidden="true" hidden></div>
  <aside class="admin-sidebar" id="adminSidebar">
    <div class="brand">Skiloora</div>
    <nav class="nav">
      <div class="section-label">Overview</div>
      <a class="nav-item active" href="./dashboard.html"><span class="icon">â–¦</span>Dashboard</a>
      <div class="section-label">Users Management</div>
      <a class="nav-sublink" href="./users.html#freelancers"><span class="icon">ğŸ‘¥</span>Freelancers</a>
      <a class="nav-sublink" href="./users.html#clients"><span class="icon">ğŸ§³</span>Clients / Hirers</a>
      <a class="nav-sublink" href="./users-manage.html">Manage Suspensions</a>
      <div class="section-label">Payments</div>
      <a class="nav-sublink" href="./payments.html#withdrawals"><span class="icon">ğŸ“„</span>Payments</a>
      <a class="nav-sublink" href="./payments.html#revenue"><span class="icon">ğŸ“ˆ</span>Revenue Dashboard</a>
      <div class="section-label">Settings</div>
      <a class="nav-sublink" href="./settings.html#roles"><span class="icon">ğŸ”‘</span>Roles &amp; Permissions</a>
      <div class="section-label">Help &amp; Support</div>
      <a class="nav-sublink" href="./issues.html"><span class="icon">â“</span>Issue Reports</a>
    </nav>
    <div class="sidebar-bottom"><button id="adminLogout" class="btn-ghost">Logout</button></div>
  </aside>

  <main class="admin-main">
    <header class="admin-topbar">
      <div class="admin-topbar-row">
        <div class="admin-topbar-left">
          <button class="mobile-menu" id="mobileMenu" aria-label="Open menu" aria-controls="adminSidebar" aria-expanded="false">â˜°</button>
          <div class="path">Admin Dashboard</div>
        </div>
        <div class="admin-user-menu" id="adminUserMenuRoot">
          <div class="avatar">A</div>
          <button id="adminUserMenuToggle" class="admin-user-caret" aria-haspopup="menu" aria-expanded="false">â–¾</button>
          <div id="adminUserMenu" class="admin-user-dropdown hidden" role="menu">
            <button id="adminMenuLogout" role="menuitem">Logout</button>
          </div>
        </div>
      </div>
    </header>

    <section class="section">
      <h2>Overview</h2>
      <p class="muted">High-level metrics</p>
      <div class="metrics">
        <div class="metric-card"><div class="metric-title">Total Users</div><div class="metric-value" id="mTotalUsers">â€”</div><div class="metric-sub" id="mTotalUsersSub">â€”</div></div>
        <div class="metric-card"><div class="metric-title">Active Freelancers</div><div class="metric-value" id="mActiveFree">â€”</div><div class="metric-sub" id="mActiveFreeSub">â€”</div></div>
        <div class="metric-card"><div class="metric-title">Total Revenue</div><div class="metric-value" id="mRevenue">â€”</div><div class="metric-sub" id="mRevenueSub">â€”</div></div>
      </div>
      <div class="charts">
        <div class="chart-card"><div class="chart-title">Monthly Revenue Breakdown</div><canvas id="revenueChart"></canvas></div>
        <div class="chart-card"><div class="chart-title">User Growth Trend</div><canvas id="userChart"></canvas></div>
      </div>
    </section>
  </main>

  <script src="../js/dashboard.js"></script>
  <script>
    // Admin user menu dropdown toggle
    (function(){
      const menuRoot = document.getElementById('adminUserMenuRoot');
      const menuToggle = document.getElementById('adminUserMenuToggle');
      const menu = document.getElementById('adminUserMenu');
      const menuLogout = document.getElementById('adminMenuLogout');
      
      if (menuToggle && menu) {
        menuToggle.addEventListener('click', (e) => {
          e.stopPropagation();
          const isOpen = !menu.classList.contains('hidden');
          menu.classList.toggle('hidden', isOpen);
          menuToggle.setAttribute('aria-expanded', String(!isOpen));
        });
        
        document.addEventListener('click', (e) => {
          if (menuRoot && !menuRoot.contains(e.target)) {
            menu.classList.add('hidden');
            menuToggle.setAttribute('aria-expanded', 'false');
          }
        });
      }
      
      if (menuLogout) {
        menuLogout.addEventListener('click', () => {
          localStorage.removeItem('skiloora_admin_session');
          const loginUrl = `${location.origin.replace(/\/$/, '')}/freelancer/html/login.html`;
          window.location.href = loginUrl;
        });
      }
    })();
  </script>
</body>
</html>